import re as ğŸ¦Œ
def a(s):
    pattern_number = r"(\d+)"
    matches = ğŸ¦Œ.finditer(pattern_number, s)
    
    0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£ = []
    ğŸ”ˆğŸ”‰ğŸ”Š = []
    
    for match in matches:
        number = int(match.group())
        index = match.start()
        0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£.append(number)
        ğŸ”ˆğŸ”‰ğŸ”Š.append(index)
    return 0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£, ğŸ”ˆğŸ”‰ğŸ”Š

def b(s):
    pattern_number = r"\*"
    matches = ğŸ¦Œ.finditer(pattern_number, s)
    
    âœ¨ğŸ”¢ = []
    
    for match in matches:
        âœ¨0ï¸âƒ£ = match.start()
        âœ¨ğŸ”¢.append(âœ¨0ï¸âƒ£)
    return âœ¨ğŸ”¢
        
with open("Day03.txt", "r") as f:
    contents = f.read()
    
ğŸ“ğŸ“ = contents.split(sep="\n")

0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£ = [None]*len(ğŸ“ğŸ“)
ğŸ”ˆğŸ”‰ğŸ”Š = [None]*len(ğŸ“ğŸ“)
âœ¨ğŸ”¢ = [None]*len(ğŸ“ğŸ“)
0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£ğŸ“ = []
ğŸ‘» = []
line_sum = []

for i in range(len(ğŸ“ğŸ“)):
    0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[i], ğŸ”ˆğŸ”‰ğŸ”Š[i] = a(ğŸ“ğŸ“[i])
    âœ¨ğŸ”¢[i] = b(ğŸ“ğŸ“[i])
    0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£ğŸ“.append([len(str(number)) for number in 0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[i]])
    ğŸ‘».append([0 for number in 0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[i]])
    
âš™ï¸ğŸ”¢ = [[[]for _ in range(7)] for _ in range(150)]

for ğŸ¥• in range(len(ğŸ“ğŸ“)):
    if len(âœ¨ğŸ”¢[ğŸ¥•]) > 0:
        for ğŸŒ in range(len(âœ¨ğŸ”¢[ğŸ¥•])):
            for ğŸ¥ in range(max(ğŸ¥•-1,0), min(ğŸ¥•+2, len(ğŸ“ğŸ“))):
                ğŸ† = max(âœ¨ğŸ”¢[ğŸ¥•][ğŸŒ]-1, 0)
                while ğŸ† < min(âœ¨ğŸ”¢[ğŸ¥•][ğŸŒ] + 2, len(ğŸ“ğŸ“[ğŸ¥•])):
                    if ğŸ† in ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥]:
                        âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ].append(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[ğŸ¥][ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥].index(ğŸ†)])
                        ğŸ† += 0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£ğŸ“[ğŸ¥][ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥].index(ğŸ†)]
                    elif ğŸ“ğŸ“[ğŸ¥][ğŸ†].isdigit() and ğŸ“ğŸ“[ğŸ¥][ğŸ†+1].isdigit():
                        âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ].append(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[ğŸ¥][ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥].index(ğŸ†-1)])
                        ğŸ† += 2
                    elif ğŸ“ğŸ“[ğŸ¥][ğŸ†].isdigit() and ğŸ“ğŸ“[ğŸ¥][ğŸ†+1] == "*":
                        if ğŸ†-1 in ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥]:
                            âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ].append(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[ğŸ¥][ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥].index(ğŸ†-1)])
                        elif ğŸ†-2 in ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥]:
                            âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ].append(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[ğŸ¥][ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥].index(ğŸ†-2)])
                        else:
                            print("Oh no")
                        ğŸ† += 2
                    elif ğŸ“ğŸ“[ğŸ¥][ğŸ†].isdigit() and ğŸ“ğŸ“[ğŸ¥][ğŸ†+1] == ".":
                        if ğŸ†-1 in ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥]:
                            âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ].append(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[ğŸ¥][ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥].index(ğŸ†-1)])
                        elif ğŸ†-2 in ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥]:
                            âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ].append(0ï¸âƒ£1ï¸âƒ£2ï¸âƒ£[ğŸ¥][ğŸ”ˆğŸ”‰ğŸ”Š[ğŸ¥].index(ğŸ†-2)])
                        else:
                            print("Oh no")
                        ğŸ† += 1
                    else:
                        ğŸ† += 1

prod = []
for ğŸ¥• in range(len(âš™ï¸ğŸ”¢)):
    for ğŸŒ in range(len(âš™ï¸ğŸ”¢[ğŸ¥•])):
        if len(âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ]) == 2:
            prod.append(âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ][0] * âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ][1])
        else:
            for ğŸ¥ in range(len(âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ])):
                âš™ï¸ğŸ”¢[ğŸ¥•][ğŸŒ][ğŸ¥] = 0
print(sum(prod))